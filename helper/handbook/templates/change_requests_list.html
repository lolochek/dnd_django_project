{% extends 'base.html' %}

{% block page_content %}
<h1>Запросы на изменение</h1>

<table border="1" cellpadding="5" cellspacing="0">
    <tr>
        <th>Пользователь</th>
        <th>Объект</th>
        <th>Изменения</th>
        <th>Дата</th>
        <th>Статус</th>
        <th>Действия</th>
    </tr>
    {% for req in change_requests %}
    <tr>
        <td>{{ req.user.username }}</td>
        <td>{{ req.content_object }}</td>
        <td>
            <h4>Изменения:</h4>
                        <ul>
                            {% for key, value in req.changes.items %}
                            <li>

                                <strong>{{ key }}</strong>: <span style="color: green">{{ value }}</span>
                            </li>
                            {% endfor %}
                        </ul>
        </td>
        <td>{{ req.created_at }}</td>
        <td>
            {% if req.status == 'pending' %}
                <span style="color: orange;">В обработке</span>
            {% elif req.status == 'approved' %}
                <span style="color: green;">Принята</span>
            {% else %}
                <span style="color: red;">Отклонена</span>
            {% endif %}
        </td>
        <td>
            {% if req.status == 'pending' %}
                <a href="{% url 'process_change_request' req.id 'approve' %}" style="color: green;">✔ Принять</a> |
                <a href="{% url 'process_change_request' req.id 'reject' %}" style="color: red;">✖ Отклонить</a>
            {% else %}
                -
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</table>

{% endblock %}
